function getURLVar(a) {
	var d = [];
	var c = String(document.location).split("?");
	if (c[1]) {
		var e = c[1].split("&");
		for (i = 0; i < e.length; i++) {
			var b = e[i].split("=");
			if (b[0] && b[1]) {
				d[b[0]] = b[1]
			}
		}
		if (d[a]) {
			return d[a]
		} else {
			return ""
		}
	} else {
		var c = String(document.location.pathname).split("/");
		if (c[c.length - 1] == "cart") {
			d.route = "checkout/cart"
		}
		if (c[c.length - 1] == "checkout") {
			d.route = "checkout/checkout"
		}
		if (d[a]) {
			return d[a]
		} else {
			return ""
		}
	}
}
$(document).ready(function () {
	var a = window.matchMedia("(min-width: 1200px)");
	$(".text-danger").each(function () {
		var c = $(this).parent().parent();
		if (c.hasClass("form-group")) {
			c.addClass("has-error")
		}
	});
	$(".mobile-menu__us").click(function () {
		$("#mobile-us").addClass("open");
		$("body").addClass("no-scroll")
	});
	$(".mobile-close").click(function () {
		$("#mobile-us").removeClass("open");
		$("body").removeClass("no-scroll");
		return false
	});

	$(document).on('click', function(e) {
		if (!$(e.target).closest('.menu-fixed').length) {
			$(".modal-backdrop").remove();
			$(".menu-fixed").removeClass("open");
			$("body").removeClass("no-scroll");
		}
	});

	$('.menu-fixed').on('click', function(e) {
		e.stopPropagation();
	});



	$(".mobile-toggle").click(function (e) {

		$("body").addClass("no-scroll");
		$("body").append('<div class="modal-backdrop fade in"></div>');
		/*$(".menu-fixed").append('<button type="button" class="menu-close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>');
		*/
		$(".menu-fixed").addClass("open");
		if ($(".menu-fixed").hasClass("open")) {

			/*$(".menu-close").click(function () {
				$(".menu-fixed").removeClass("open");
				$("body").removeClass("no-scroll");
				$(".modal-backdrop, .menu-close").remove();
				$(this).fadeOut();
				return false
			})*/


		}
		e.stopPropagation();
	});
	$(".reward-questions").hover(function () {
		$(".dropdown-box").addClass("visible")
	}, function () {
		$(".dropdown-box").removeClass("visible")
	});
	$(".form-currency .currency-select").on("click", function (c) {
		c.preventDefault();
		$(".form-currency input[name='code']").val($(this).attr("name"));
		$(".form-currency").submit()
	});
	$(".form-language .language-select").on("click", function (c) {
		c.preventDefault();
		$(".form-language input[name='code']").val($(this).attr("name"));
		$(".form-language").submit()
	});

	$("#search input[name='search']").parent().find("button").on("click", function () {
		var c = $("base").attr("href") + "index.php?route=product/search";
		var d = $("#search input[name='search']").val();
		if (d) {
			c += "&search=" + encodeURIComponent(d)
		}
		location = c
	});

	$("#search input[name='search']").on("keydown", function (c) {
		if (c.keyCode == 13) {
			$("#search input[name='search']").parent().find("button").trigger("click")
		}
	});

	// Product List
	$('#list-view').click(function() {
		$('#content .goods').attr('class', 'row goods goods-list');
		$('#grid-view').removeClass('active');
		$('#list-view').addClass('active');

		localStorage.setItem('display', 'list');
	});

	// Product Grid
	$('#grid-view').click(function() {

		var cols = $("#column-right, #column-left").length;

		if (cols == 2) {
			$("#content .goods").attr("class", "row goods goods-grid row-cols-xxxl-3 row-cols-xxl-2 row-cols-xl-1");
			$("#content").addClass("content-columns")
		} else if (cols == 1) {
			$("#content .goods").attr("class", "row goods goods-grid row-cols-xxxl-3 row-cols-xxl-3 row-cols-xl-3 row-cols-lg-2 row-cols-sm-2");
			$("#content").addClass("content-column")
		} else {
			$("#content .goods").attr("class", "row goods goods-grid row-cols-xxxl-5 row-cols-xxl-4 row-cols-xl-3 row-cols-lg-2 row-cols-sm-2");
			$("#content").addClass("content-large")
		}

		$('#list-view').removeClass('active');
		$('#grid-view').addClass('active');

		localStorage.setItem('display', 'grid');
	});

	if (localStorage.getItem('display') == 'list') {
		$('#list-view').trigger('click');
		$('#list-view').addClass('active');
	} else {
		$('#grid-view').trigger('click');
		$('#grid-view').addClass('active');
	}

	$(document).on("keydown", "#collapse-checkout-option input[name='email'], #collapse-checkout-option input[name='password']", function (c) {
		if (c.keyCode == 13) {
			$("#collapse-checkout-option #button-login").trigger("click")
		}
	});

	$("[data-toggle='tooltip']").tooltip({
		container: "body"
	});

	$(document).ajaxStop(function () {
		$("[data-toggle='tooltip']").tooltip({
			container: "body"
		})
	})
});
var cart = {
	add: function (b, c, a) {
		$.ajax({
			url: "index.php?route=checkout/cart/add",
			type: "post",
			data: "product_id=" + b + "&quantity=" + (typeof (c) != "undefined" ? c : 1),
			dataType: "json",
			success: function (d) {
				$("#modal-cart").remove();
				if (d.redirect) {
					location = d.redirect
				}
				if (d.success) {
					html = '<div id="modal-cart" class="modal fade">';
					html += '  <div class="modal-dialog modal-cart__dialog">';
					html += '    <div class="modal-content modal-cart__content">';
					html += '      <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>';
					html += '      <div class="modal-cart__header">';
					html += '        <div class="modal-cart__title">' + d.title + "</div>";
					html += "      </div>";
					html += '      <div class="modal-cart__body">';
					html += '        <div class="modal-cart__img">';
					html += '          <img src="' + d.img + '" title="' + d.name + '" alt="' + d.name + '">';
					html += "        </div>";
					html += '	     <div class="modal-cart__name"><span class="modal-cart__name--value">' + d.name + '</span><span class="modal-sku">' + d.sku + "</span>" + d.stock + "<span class='text-dost'>Бесплатная доставка</span></div>";
					html += "      </div>";
					html += '      <div class="modal-cart__footer">';
					html += '        <button type="button" class="btn btn-secondary" data-dismiss="modal">' + d.continue_shopping + "</button>" + d.checkout + "";
					html += "      </div>";
					html += "    </div>";
					html += "  </div>";
					html += "</div>";
					$("body").append(html);
					$("#modal-cart").modal("show");
					setTimeout(function () {
						$(".header-cart > a").html('<svg class="svg-icon icon icon-cart" width="24" height="24" viewBox="0 0 20 20"><path fill="#000" d="M17.72,5.011H8.026c-0.271,0-0.49,0.219-0.49,0.489c0,0.271,0.219,0.489,0.49,0.489h8.962l-1.979,4.773H6.763L4.935,5.343C4.926,5.316,4.897,5.309,4.884,5.286c-0.011-0.024,0-0.051-0.017-0.074C4.833,5.166,4.025,4.081,2.33,3.908C2.068,3.883,1.822,4.075,1.795,4.344C1.767,4.612,1.962,4.853,2.231,4.88c1.143,0.118,1.703,0.738,1.808,0.866l1.91,5.661c0.066,0.199,0.252,0.333,0.463,0.333h8.924c0.116,0,0.22-0.053,0.308-0.128c0.027-0.023,0.042-0.048,0.063-0.076c0.026-0.034,0.063-0.058,0.08-0.099l2.384-5.75c0.062-0.151,0.046-0.323-0.045-0.458C18.036,5.092,17.883,5.011,17.72,5.011z"></path><path fill="#000" d="M8.251,12.386c-1.023,0-1.856,0.834-1.856,1.856s0.833,1.853,1.856,1.853c1.021,0,1.853-0.83,1.853-1.853S9.273,12.386,8.251,12.386z M8.251,15.116c-0.484,0-0.877-0.393-0.877-0.874c0-0.484,0.394-0.878,0.877-0.878c0.482,0,0.875,0.394,0.875,0.878C9.126,14.724,8.733,15.116,8.251,15.116z"></path><path fill="#000" d="M13.972,12.386c-1.022,0-1.855,0.834-1.855,1.856s0.833,1.853,1.855,1.853s1.854-0.83,1.854-1.853S14.994,12.386,13.972,12.386z M13.972,15.116c-0.484,0-0.878-0.393-0.878-0.874c0-0.484,0.394-0.878,0.878-0.878c0.482,0,0.875,0.394,0.875,0.878C14.847,14.724,14.454,15.116,13.972,15.116z"></path></svg>' + d.total + "");
						$(".mobile-menu__cart span").html(d.countProducts)
					}, 100)
				}
			},
			error: function (f, d, e) {
				alert(e + "\r\n" + f.statusText + "\r\n" + f.responseText)
			}
		})
	},
	update: function (a, b) {
		$.ajax({
			url: "index.php?route=checkout/cart/edit",
			type: "post",
			data: "key=" + a + "&quantity=" + (typeof (b) != "undefined" ? b : 1),
			dataType: "json",
			success: function (c) {
				setTimeout(function () {
					$(".header-cart > a").html('<svg class="svg-icon icon icon-cart" width="24" height="24" viewBox="0 0 20 20"><path fill="#000" d="M17.72,5.011H8.026c-0.271,0-0.49,0.219-0.49,0.489c0,0.271,0.219,0.489,0.49,0.489h8.962l-1.979,4.773H6.763L4.935,5.343C4.926,5.316,4.897,5.309,4.884,5.286c-0.011-0.024,0-0.051-0.017-0.074C4.833,5.166,4.025,4.081,2.33,3.908C2.068,3.883,1.822,4.075,1.795,4.344C1.767,4.612,1.962,4.853,2.231,4.88c1.143,0.118,1.703,0.738,1.808,0.866l1.91,5.661c0.066,0.199,0.252,0.333,0.463,0.333h8.924c0.116,0,0.22-0.053,0.308-0.128c0.027-0.023,0.042-0.048,0.063-0.076c0.026-0.034,0.063-0.058,0.08-0.099l2.384-5.75c0.062-0.151,0.046-0.323-0.045-0.458C18.036,5.092,17.883,5.011,17.72,5.011z"></path><path fill="#000" d="M8.251,12.386c-1.023,0-1.856,0.834-1.856,1.856s0.833,1.853,1.856,1.853c1.021,0,1.853-0.83,1.853-1.853S9.273,12.386,8.251,12.386z M8.251,15.116c-0.484,0-0.877-0.393-0.877-0.874c0-0.484,0.394-0.878,0.877-0.878c0.482,0,0.875,0.394,0.875,0.878C9.126,14.724,8.733,15.116,8.251,15.116z"></path><path fill="#000" d="M13.972,12.386c-1.022,0-1.855,0.834-1.855,1.856s0.833,1.853,1.855,1.853s1.854-0.83,1.854-1.853S14.994,12.386,13.972,12.386z M13.972,15.116c-0.484,0-0.878-0.393-0.878-0.874c0-0.484,0.394-0.878,0.878-0.878c0.482,0,0.875,0.394,0.875,0.878C14.847,14.724,14.454,15.116,13.972,15.116z"></path></svg>' + c.total + "");
					$(".mobile-menu__cart span").html(c.countProducts)
				}, 100);
				if (getURLVar("route") == "checkout/cart" || getURLVar("route") == "checkout/checkout") {
					location = "index.php?route=checkout/cart"
				} else {
					$(".header-cart > ul").load("index.php?route=common/cart/info ul li")
				}
			},
			error: function (e, c, d) {
				alert(d + "\r\n" + e.statusText + "\r\n" + e.responseText)
			}
		})
	},
	remove: function (a) {
		$.ajax({
			url: "index.php?route=checkout/cart/remove",
			type: "post",
			data: "key=" + a,
			dataType: "json",
			success: function (b) {
				setTimeout(function () {
					$(".header-cart > a").html('<svg class="svg-icon icon icon-cart" width="24" height="24" viewBox="0 0 20 20"><path fill="#000" d="M17.72,5.011H8.026c-0.271,0-0.49,0.219-0.49,0.489c0,0.271,0.219,0.489,0.49,0.489h8.962l-1.979,4.773H6.763L4.935,5.343C4.926,5.316,4.897,5.309,4.884,5.286c-0.011-0.024,0-0.051-0.017-0.074C4.833,5.166,4.025,4.081,2.33,3.908C2.068,3.883,1.822,4.075,1.795,4.344C1.767,4.612,1.962,4.853,2.231,4.88c1.143,0.118,1.703,0.738,1.808,0.866l1.91,5.661c0.066,0.199,0.252,0.333,0.463,0.333h8.924c0.116,0,0.22-0.053,0.308-0.128c0.027-0.023,0.042-0.048,0.063-0.076c0.026-0.034,0.063-0.058,0.08-0.099l2.384-5.75c0.062-0.151,0.046-0.323-0.045-0.458C18.036,5.092,17.883,5.011,17.72,5.011z"></path><path fill="#000" d="M8.251,12.386c-1.023,0-1.856,0.834-1.856,1.856s0.833,1.853,1.856,1.853c1.021,0,1.853-0.83,1.853-1.853S9.273,12.386,8.251,12.386z M8.251,15.116c-0.484,0-0.877-0.393-0.877-0.874c0-0.484,0.394-0.878,0.877-0.878c0.482,0,0.875,0.394,0.875,0.878C9.126,14.724,8.733,15.116,8.251,15.116z"></path><path fill="#000" d="M13.972,12.386c-1.022,0-1.855,0.834-1.855,1.856s0.833,1.853,1.855,1.853s1.854-0.83,1.854-1.853S14.994,12.386,13.972,12.386z M13.972,15.116c-0.484,0-0.878-0.393-0.878-0.874c0-0.484,0.394-0.878,0.878-0.878c0.482,0,0.875,0.394,0.875,0.878C14.847,14.724,14.454,15.116,13.972,15.116z"></path></svg>' + b.total + "");
					$(".mobile-menu__cart span").html(b.countProducts)
				}, 100);
				if (getURLVar("route") == "checkout/cart" || getURLVar("route") == "checkout/checkout") {
					location = "index.php?route=checkout/cart"
				} else {
					$(".header-cart > ul").load("index.php?route=common/cart/info ul li")
				}
			},
			error: function (d, b, c) {
				alert(c + "\r\n" + d.statusText + "\r\n" + d.responseText)
			}
		})
	}
};
var voucher = {
	add: function () {},
	remove: function (a) {
		$.ajax({
			url: "index.php?route=checkout/cart/remove",
			type: "post",
			data: "key=" + a,
			dataType: "json",
			success: function (b) {
				setTimeout(function () {
					$(".header-cart > a").html('<svg class="svg-icon icon icon-cart" width="24" height="24" viewBox="0 0 20 20"><path fill="#000" d="M17.72,5.011H8.026c-0.271,0-0.49,0.219-0.49,0.489c0,0.271,0.219,0.489,0.49,0.489h8.962l-1.979,4.773H6.763L4.935,5.343C4.926,5.316,4.897,5.309,4.884,5.286c-0.011-0.024,0-0.051-0.017-0.074C4.833,5.166,4.025,4.081,2.33,3.908C2.068,3.883,1.822,4.075,1.795,4.344C1.767,4.612,1.962,4.853,2.231,4.88c1.143,0.118,1.703,0.738,1.808,0.866l1.91,5.661c0.066,0.199,0.252,0.333,0.463,0.333h8.924c0.116,0,0.22-0.053,0.308-0.128c0.027-0.023,0.042-0.048,0.063-0.076c0.026-0.034,0.063-0.058,0.08-0.099l2.384-5.75c0.062-0.151,0.046-0.323-0.045-0.458C18.036,5.092,17.883,5.011,17.72,5.011z"></path><path fill="#000" d="M8.251,12.386c-1.023,0-1.856,0.834-1.856,1.856s0.833,1.853,1.856,1.853c1.021,0,1.853-0.83,1.853-1.853S9.273,12.386,8.251,12.386z M8.251,15.116c-0.484,0-0.877-0.393-0.877-0.874c0-0.484,0.394-0.878,0.877-0.878c0.482,0,0.875,0.394,0.875,0.878C9.126,14.724,8.733,15.116,8.251,15.116z"></path><path fill="#000" d="M13.972,12.386c-1.022,0-1.855,0.834-1.855,1.856s0.833,1.853,1.855,1.853s1.854-0.83,1.854-1.853S14.994,12.386,13.972,12.386z M13.972,15.116c-0.484,0-0.878-0.393-0.878-0.874c0-0.484,0.394-0.878,0.878-0.878c0.482,0,0.875,0.394,0.875,0.878C14.847,14.724,14.454,15.116,13.972,15.116z"></path></svg>' + b.total + "");
					$(".mobile-menu__cart span").html(b.countProducts)
				}, 100);
				if (getURLVar("route") == "checkout/cart" || getURLVar("route") == "checkout/checkout") {
					location = "index.php?route=checkout/cart"
				} else {
					$(".header-cart > ul").load("index.php?route=common/cart/info ul li")
				}
			},
			error: function (d, b, c) {
				alert(c + "\r\n" + d.statusText + "\r\n" + d.responseText)
			}
		})
	}
};
var wishlist = {
	add: function (a) {
		$.ajax({
			url: "index.php?route=account/wishlist/add",
			type: "post",
			data: "product_id=" + a,
			dataType: "json",
			success: function (b) {
				$(".popupshow").remove();
				if (b.redirect) {
					location = b.redirect
				}
				if (b.success) {
					if (b.logged) {
						$("body").append('<div class="popupshow"><div class="alert alert-success alert-dismissible alertsuc zoomIn animated"><span class="check-success"></span>' + b.success + '<button type="button" class="close" data-dismiss="alert"></button></div></div>')
					} else {
						$("body").append('<div class="popupshow"><div class="alert alert-danger alert-dismissible alertsuc zoomIn animated"><span class="check-danger"></span>' + b.success + '<button type="button" class="close" data-dismiss="alert"></button></div></div>')
					}

					$(".popupshow").delay(4000).fadeOut();
					$("button.close").click(function () {
						$(".popupshow").remove()
					})
				}
				$(".wishlist-total").html(b.total)
			},
			error: function (d, b, c) {
				alert(c + "\r\n" + d.statusText + "\r\n" + d.responseText)
			}
		})
	},
	remove: function () {}
};
var compare = {
	add: function (a) {
		$.ajax({
			url: "index.php?route=product/compare/add",
			type: "post",
			data: "product_id=" + a,
			dataType: "json",
			success: function (b) {
				$(".popupshow").remove();
				if (b.success) {
					$("body").append('<div class="popupshow"><div class="alert alert-success alert-dismissible alertsuc zoomIn animated"><button class="close"><img src="/image/catalog/icon-svg/close.svg"></button><span class="check-success"></span>' + b.success + '<button type="button" class="close" data-dismiss="alert"></button></div></div>');
					$("#compare-total").html(b.total)
				}
				$(".popupshow").delay(4000).fadeOut();
				$("button.close").click(function () {
					$(".popupshow").remove()
				})
			},
			error: function (d, b, c) {
				alert(c + "\r\n" + d.statusText + "\r\n" + d.responseText)
			}
		})
	},
	remove: function () {}
};
$(document).delegate(".agree", "click", function (b) {
	b.preventDefault();
	$("#modal-agree").remove();
	var a = this;
	$.ajax({
		url: $(a).attr("href"),
		type: "get",
		dataType: "html",
		success: function (c) {
			html = '<div id="modal-agree" class="modal">';
			html += '  <div class="modal-dialog">';
			html += '    <div class="modal-content">';
			html += '      <div class="modal-header">';
			html += '        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>';
			html += '        <h4 class="modal-title">' + $(a).text() + "</h4>";
			html += "      </div>";
			html += '      <div class="modal-body">' + c + "</div>";
			html += "    </div>";
			html += "  </div>";
			html += "</div>";
			$("body").append(html);
			$("#modal-agree").modal("show")
		}
	})
});
(function (a) {
	a.fn.autocomplete = function (b) {
		return this.each(function () {
			this.timer = null;
			this.items = new Array();
			a.extend(this, b);
			a(this).attr("autocomplete", "off");
			a(this).on("focus", function () {
				this.request()
			});
			a(this).on("blur", function () {
				setTimeout(function (c) {
					c.hide()
				}, 200, this)
			});
			a(this).on("keydown", function (c) {
				switch (c.keyCode) {
					case 27:
						this.hide();
						break;
					default:
						this.request();
						break
				}
			});
			this.click = function (c) {
				c.preventDefault();
				value = a(c.target).parent().attr("data-value");
				if (value && this.items[value]) {
					this.select(this.items[value])
				}
			};
			this.show = function () {
				var c = a(this).position();
				a(this).siblings("ul.dropdown-menu").css({
					top: c.top + a(this).outerHeight(),
					left: c.left
				});
				a(this).siblings("ul.dropdown-menu").show()
			};
			this.hide = function () {
				a(this).siblings("ul.dropdown-menu").hide()
			};
			this.request = function () {
				clearTimeout(this.timer);
				this.timer = setTimeout(function (c) {
					c.source(a(c).val(), a.proxy(c.response, c))
				}, 200, this)
			};
			this.response = function (c) {
				html = "";
				if (c.length) {
					for (i = 0; i < c.length; i++) {
						this.items[c[i]["value"]] = c[i]
					}
					for (i = 0; i < c.length; i++) {
						if (!c[i]["category"]) {
							html += '<li data-value="' + c[i]["value"] + '"><a href="#">' + c[i]["label"] + "</a></li>"
						}
					}
					var d = new Array();
					for (i = 0; i < c.length; i++) {
						if (c[i]["category"]) {
							if (!d[c[i]["category"]]) {
								d[c[i]["category"]] = new Array();
								d[c[i]["category"]]["name"] = c[i]["category"];
								d[c[i]["category"]]["item"] = new Array()
							}
							d[c[i]["category"]]["item"].push(c[i])
						}
					}
					for (i in d) {
						html += '<li class="dropdown-header">' + d[i]["name"] + "</li>";
						for (j = 0; j < d[i]["item"].length; j++) {
							html += '<li data-value="' + d[i]["item"][j]["value"] + '"><a href="#">   ' + d[i]["item"][j]["label"] + "</a></li>"
						}
					}
				}
				if (html) {
					this.show()
				} else {
					this.hide()
				}
				a(this).siblings("ul.dropdown-menu").html(html)
			};
			a(this).after('<ul class="dropdown-menu"></ul>');
			a(this).siblings("ul.dropdown-menu").delegate("a", "click", a.proxy(this.click, this))
		})
	}
})(window.jQuery);
